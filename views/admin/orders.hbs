

            <!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Corona Admin</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="../../assets/vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="../../assets/vendors/css/vendor.bundle.base.css">
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="../../assets/css/style.css">
    <!-- End layout styles -->
    <link rel="shortcut icon" href="../../assets/images/favicon.png" />
  </head>
 <style>
  .action-section {
  position: relative;
  display: inline-block;
}

.dropbtn {
  background-color: transparent;
  border: none;
  cursor: pointer;
  font-size: 18px;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
  z-index: 99999;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown-content a:hover {
  background-color: #f1f1f1;
}

.dropdown:hover .dropdown-content {
  display: block;
}

.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index:999991; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0, 0, 0); /* Fallback color */
  background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
  padding-top: 60px;
}

.modal-content {
  background-color: #fefefe;
  margin: 5% auto; /* 15% from the top and centered */
  padding: 20px;
  border: 1px solid #888;
  width: 80%; /* Could be more or less, depending on screen size */
}

.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

#updateStatusBtn {
  margin-top: 10px;
  padding: 8px 16px;
  background-color: #007bff;
  color: white;
  border: none;
  cursor: pointer;
}

#updateStatusBtn:hover {
  background-color: #0056b3;
}

 </style>
  <body>
    <div class="container-scroller">
      <!-- partial:../../partials/_sidebar.html -->
     {{>adminSidebar}}
      <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <!-- partial:../../partials/_navbar.html -->
        <nav class="navbar p-0 fixed-top d-flex flex-row">
          <div class="navbar-brand-wrapper d-flex d-lg-none align-items-center justify-content-center">
            <a class="navbar-brand brand-logo-mini" href="../../index.html"><img src="../../assets/images/logo-mini.svg" alt="logo" /></a>
          </div>
          <div class="navbar-menu-wrapper flex-grow d-flex align-items-stretch">
            <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
              <span class="mdi mdi-menu"></span>
            </button>
            <ul class="navbar-nav w-100">
              <li class="nav-item w-100">
                <form class="nav-link mt-2 mt-md-0 d-none d-lg-flex search">
                  <input type="text" class="form-control" placeholder="Search products">
                </form>
              </li>
            </ul>
            <ul class="navbar-nav navbar-nav-right">
              <li class="nav-item dropdown d-none d-lg-block">
                <a class="nav-link btn btn-success create-new-button" id="createbuttonDropdown" data-toggle="dropdown" aria-expanded="false" href="#">+ Create New Project</a>
                <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="createbuttonDropdown">
                  <h6 class="p-3 mb-0">Projects</h6>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-dark rounded-circle">
                        <i class="mdi mdi-file-outline text-primary"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject ellipsis mb-1">Software Development</p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-dark rounded-circle">
                        <i class="mdi mdi-web text-info"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject ellipsis mb-1">UI Development</p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-dark rounded-circle">
                        <i class="mdi mdi-layers text-danger"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject ellipsis mb-1">Software Testing</p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <p class="p-3 mb-0 text-center">See all projects</p>
                </div>
              </li>
              <li class="nav-item nav-settings d-none d-lg-block">
                <a class="nav-link" href="#">
                  <i class="mdi mdi-view-grid"></i>
                </a>
              </li>
              <li class="nav-item dropdown border-left">
                <a class="nav-link count-indicator dropdown-toggle" id="messageDropdown" href="#" data-toggle="dropdown" aria-expanded="false">
                  <i class="mdi mdi-email"></i>
                  <span class="count bg-success"></span>
                </a>
                <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="messageDropdown">
                  <h6 class="p-3 mb-0">Messages</h6>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <img src="../../assets/images/faces/face4.jpg" alt="image" class="rounded-circle profile-pic">
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject ellipsis mb-1">Mark send you a message</p>
                      <p class="text-muted mb-0"> 1 Minutes ago </p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <img src="../../assets/images/faces/face2.jpg" alt="image" class="rounded-circle profile-pic">
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject ellipsis mb-1">Cregh send you a message</p>
                      <p class="text-muted mb-0"> 15 Minutes ago </p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <img src="../../assets/images/faces/face3.jpg" alt="image" class="rounded-circle profile-pic">
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject ellipsis mb-1">Profile picture updated</p>
                      <p class="text-muted mb-0"> 18 Minutes ago </p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <p class="p-3 mb-0 text-center">4 new messages</p>
                </div>
              </li>
              <li class="nav-item dropdown border-left">
                <a class="nav-link count-indicator dropdown-toggle" id="notificationDropdown" href="#" data-toggle="dropdown">
                  <i class="mdi mdi-bell"></i>
                  <span class="count bg-danger"></span>
                </a>
                <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
                  <h6 class="p-3 mb-0">Notifications</h6>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-dark rounded-circle">
                        <i class="mdi mdi-calendar text-success"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject mb-1">Event today</p>
                      <p class="text-muted ellipsis mb-0"> Just a reminder that you have an event today </p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-dark rounded-circle">
                        <i class="mdi mdi-settings text-danger"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject mb-1">Settings</p>
                      <p class="text-muted ellipsis mb-0"> Update dashboard </p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-dark rounded-circle">
                        <i class="mdi mdi-link-variant text-warning"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject mb-1">Launch Admin</p>
                      <p class="text-muted ellipsis mb-0"> New admin wow! </p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <p class="p-3 mb-0 text-center">See all notifications</p>
                </div>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link" id="profileDropdown" href="#" data-toggle="dropdown">
                  <div class="navbar-profile">
                    <img class="img-xs rounded-circle" src="../../assets/images/faces/face15.jpg" alt="">
                    <p class="mb-0 d-none d-sm-block navbar-profile-name">Henry Klein</p>
                    <i class="mdi mdi-menu-down d-none d-sm-block"></i>
                  </div>
                </a>
                <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="profileDropdown">
                  <h6 class="p-3 mb-0">Profile</h6>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-dark rounded-circle">
                        <i class="mdi mdi-settings text-success"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject mb-1">Settings</p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-dark rounded-circle">
                        <i class="mdi mdi-logout text-danger"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject mb-1">Log out</p>
                    </div>
                  </a>
                  <div class="dropdown-divider"></div>
                  <p class="p-3 mb-0 text-center">Advanced settings</p>
                </div>
              </li>
            </ul>
            <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
              <span class="mdi mdi-format-line-spacing"></span>
            </button>
          </div>
        </nav>
        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper">
            <div class="page-header">
              <h3 class="page-title"> Order Management </h3>
               <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <a href="/view-products" class="btn btn-success ml-auto"> </a>
                 
                </ol>
              </nav>
            </div>
            <div class="row ">
              <div class="col-12 grid-margin">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Order Status</h4>
                    <div class="table-responsive">
                      <table class="table">
                        <thead>
                          <tr>
                            
                            
                            <th> Order ID </th>
                            <th> Customer </th>
                            <th> Products </th>
                          <th>Total Amount</th>
                            <th> Payment Mode </th>
                            {{!-- <th> Start Date </th> --}}
                            <th> Status </th>
                            <th>Action</th>
                          </tr>
                        </thead>
                        {{#each orders}}
                        <tbody>
                          <tr>
                            <td>{{this.orderid}}</td>
                            <td> {{this.userid.fullName}} </td>
                            <td>  <img src="img/productImages/{{this}}" alt="image" /> </td>
                            <td> {{this.totalPrice}}</td>
                          
                            <td> {{this.payment.paymentType}}</td>
                            {{!-- <td> {{this.orderedDate}}</td> --}}
                            <td>
                              <div class="badge badge-outline-success">{{this.status}}</div>
                            </td>
                            {{!-- <td><form action="/admin/order/{{this._id}}/status" method="POST">
                    <select name="status" id="orderStatus">
                       {{#each ../enumStatusValues}}
          <option value="{{this}}" {{#if (eq this ../this.status)}}selected{{/if}}>
            {{this}}
          </option>
          {{/each}}
                    </select>
                    <button type="submit">Update Status</button>
                </form> </td> --}}
                             <td>
                              <div class="action-section">
  <div class="dropdown">
    <button class="dropbtn">
      <i class="fa fa-ellipsis-v"></i> <!-- Three-dot icon -->
    </button>
    <div class="dropdown-content">
            <a href="#" class="view-address" data-address="{{this.orderid}},{{this.shippingAddress.houseName}}, {{this.shippingAddress.street}}, {{this.shippingAddress.city}}, {{this.shippingAddress.pincode}}">View<br/> Address</a>
            <a href="#" class="change-status" data-orderid="{{this.orderid}}" data-currentstatus="{{this.status}}">Change<br/>Status</a>
          </div>
  </div>
  
</div>

<!-- Modal for Shipping Address -->
<div id="addressModal" class="modal">
    <div class="modal-dialog">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Shipping Address</h2>
    <p>Order ID: {{this.orderid}}</p>
   
    <p id="shippingAddress"></p>
  </div>
  </div>
</div>



<!-- Modal for Changing Order Status -->
<div id="statusModal" class="modal">
      <div class="modal-dialog">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Change Order Status</h2>

    <form action="/admin/order/{{this._id}}/status" method="POST">
                    <select name="status" id="orderStatus">
                       {{#each ../enumStatusValues}}
          <option value="{{this}}" {{#if (eq this ../this.status)}}selected{{/if}}>
            {{this}}
          </option>
          {{/each}}
                    </select>
                    <button type="submit">Update Status</button>
                </form> 
    {{!-- <select id="orderStatus">
      <option value="packed">Packed</option>
      <option value="outForDelivery">Out for Delivery</option>
      <option value="delivered">Delivered</option>
    </select> --}}
    {{!-- <button id="updateStatusBtn">Update</button> --}}
  </div>
      </div>
</div>

                              {{!-- <div class="action-section">
  <div class="dropdown">
    <button class="dropbtn">
      <i class="fa fa-ellipsis-v"></i> <!-- Three-dot icon -->
    </button>
    <div class="dropdown-content">
      <a href="#" class="status-option" data-status="packed">Mark as Packed</a>
      <a href="#" class="status-option" data-status="outForDelivery">Mark as Out for Delivery</a>
      <a href="#" class="status-option" data-status="delivered">Mark as Delivered</a>
        <button class="update-btn">Update</button>
    </div>
  </div>

                              </div> --}}
                {{!-- <form action="/admin/order/{{this._id}}/status" method="POST">
                    <select name="status">
                        <option value="Pending" {{#if (eq this.status 'Pending')}}selected{{/if}}>Pending</option>
                         <option value="Placed" {{#if (eq this.status 'Placed')}}selected{{/if}}>Placed</option>
                        <option value="Packed" {{#if (eq this.status 'Packed')}}selected{{/if}}>Packed</option>
                        <option value="Out for Delivery" {{#if (eq this.status 'Out for Delivery')}}selected{{/if}}>Out for Delivery</option>
                        <option value="Delivered" {{#if (eq this.status 'Delivered')}}selected{{/if}}>Delivered</option>
                        <option value="Cancelled" {{#if (eq this.status 'Cancelled')}}selected{{/if}}>Cancelled</option>
                    </select>
                    <button type="submit">Update Status</button>
                </form> --}}
            </td>
                          </tr>
                         
                          
                        </tbody>
                        {{/each}}
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
             
        
          </div>
          <!-- content-wrapper ends -->
          <!-- partial:../../partials/_footer.html -->
          <footer class="footer">
            <div class="d-sm-flex justify-content-center justify-content-sm-between">
              <span class="text-muted d-block text-center text-sm-left d-sm-inline-block">Copyright © bootstrapdash.com 2020</span>
              <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center"> Free <a href="https://www.bootstrapdash.com/bootstrap-admin-template/" target="_blank">Bootstrap admin templates</a> from Bootstrapdash.com</span>
            </div>
          </footer>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="../../assets/vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="../../assets/js/off-canvas.js"></script>
    <script src="../../assets/js/hoverable-collapse.js"></script>
    <script src="../../assets/js/misc.js"></script>
    <script src="../../assets/js/settings.js"></script>
    <script src="../../assets/js/todolist.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
  // Handle "View Shipping Address" click
  document.querySelectorAll('.view-address').forEach(function (button) {
    button.addEventListener('click', function () {
      const address = this.getAttribute('data-address');
      document.getElementById('shippingAddress').innerText = address;
      document.getElementById('addressModal').style.display = 'block';
    });
  });

  // Handle "Change Order Status" click
  document.querySelectorAll('.change-status').forEach(function (button) {
    button.addEventListener('click', function () {
      const orderId = this.getAttribute('data-orderid');
      const currentStatus = this.getAttribute('data-currentstatus');
      document.getElementById('orderStatus').value = currentStatus;
      document.getElementById('statusModal').style.display = 'block';

      // Update status on button click
      document.getElementById('updateStatusBtn').onclick = function () {
        const newStatus = document.getElementById('orderStatus').value;
        fetch(`/admin/order/${orderId}/status`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ status: newStatus }),
        })
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              location.reload(); // Reload the page to reflect the new status
            } else {
              alert('Error updating status');
            }
          });
      };
    });
  });

  // Handle modal close
  document.querySelectorAll('.modal .close').forEach(function (button) {
    button.addEventListener('click', function () {
      this.closest('.modal').style.display = 'none';
    });
  });
});

    </script>
    <!-- endinject -->
    <!-- Custom js for this page -->
    <!-- End custom js for this page -->
  </body>
</html>
